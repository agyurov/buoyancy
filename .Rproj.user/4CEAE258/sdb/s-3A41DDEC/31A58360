{
    "collab_server" : "",
    "contents" : "# draft\n# source(\"../Rfunctions/Rfunctions.R\")\n\nlibrary(ggplot2)\nlibrary(deldir)\ndf = data.frame(v1 = runif(100, 0, 2),\n                v2 = runif(100, 0, 3))\n\ndf = iris[,1:4]\nresp = iris$Species\n\n\n\n\n# grid --------------------------------------------------------------------\n\nrec.grid = function(a,x){\n  # a is list of ranges for each variable\n  out = seq(a[1], a[length(a)], len = 2^x + 1)\n  return(out)\n}\n\nin.interval = function(x, y){\n  # x data, y = interval\n  # return(cbind(x, findInterval(x, y)))\n  return(findInterval(x, y, rightmost.closed = T))\n}\n\n#  ------------------------------------------------------------------------\n\n\n\n\n# algorithm ---------------------------------------------------------------\n\n\na = lapply(df, range)\ncond = T\ni = 0\nresults = result = cm = fake = gridz = list()\nnsteps = 2\nnewdf = df\n\nfor(i in 1:nsteps){\n  # i = i + 1\n  \n  # grid\n  a = lapply(a, rec.grid, x = i)\n  \n  # count\n  for(j in 1:ncol(df)){\n    fake[[j]] = in.interval(df[,j], a[[j]])\n  }\n  gridz[[i]] = do.call(paste0, fake)\n  names(gridz)[i] = paste0('g', 2^i)\n  newdf = cbind(df, do.call(paste0, fake))\n  names(newdf)[ncol(newdf)] = 'grp'\n  cm[[i]] = aggregate(.~grp, newdf, mean)\n  \n  # plot\n  plot(df[,1], df[,2], pch = 20, col = gridz[[i]])\n  abline(v = a[[1]], lty = 2, col = 'grey')\n  abline(h = a[[2]], lty = 2, col = 'grey')\n  points(cm[[i]][,2], cm[[i]][,3], pch = 4, lwd = 2, cex = 2)\n  \n  # evaluate condition\n  \n  # readline('fesfes')\n}\n\nmass = lapply(gridz, table)\nfinaldf = cbind(df, do.call(cbind.data.frame, gridz))\n\n\nfor(i in 1:nsteps){\n  results[[i]] = cbind(mass[[i]], cm[[i]])\n}\n\nresult = results[[nsteps]]\n\n\n# exploration -------------------------------------------------------------\n\ngroups = result[result$Freq %in% sort(result$Freq, decreasing = T)[1:3],]\ngroups\ntr = aggregate(. ~ Species, iris, mean)\ntr\n\n\n\n# predict -----------------------------------------------------------------\n\nmy.dist = function(x,y){\n  return(sqrt(sum((x-y)^2)))\n}\n\ng1 = apply(df, 1, my.dist, y = groups[1,4:7])\ng2 = apply(df, 1, my.dist, y = groups[2,4:7])\ng3 = apply(df, 1, my.dist, y = groups[3,4:7])\n\nprd = cbind(g1, g2, g3)\n\nprdctn = apply(prd, 1, which.min)\n\ntable(prdctn, resp)",
    "created" : 1501650277544.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2565119281",
    "id" : "31A58360",
    "lastKnownWriteTime" : 1501952923,
    "last_content_update" : 1501952923421,
    "path" : "C:/Users/Lenovo/Google Drive/Projects_personal/buoyancy/draft.R",
    "project_path" : "draft.R",
    "properties" : {
        "docOutlineVisible" : "0",
        "source_window_id" : "",
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}